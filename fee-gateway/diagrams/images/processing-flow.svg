<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="586px" preserveAspectRatio="none" style="width:815px;height:586px;" version="1.1" viewBox="0 0 815 586" width="815px" zoomAndPan="magnify"><defs><filter height="300%" id="f2l792frt5f7i" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="339.25" cy="20" fill="#000000" filter="url(#f2l792frt5f7i)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><path d="M447.25,40 L447.25,101.5313 L427.25,105.5313 L447.25,109.5313 L447.25,171.0625 A0,0 0 0 0 447.25,171.0625 L803.25,171.0625 A0,0 0 0 0 803.25,171.0625 L803.25,50 L793.25,40 L447.25,40 A0,0 0 0 0 447.25,40 " fill="#FBFB77" filter="url(#f2l792frt5f7i)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M793.25,40 L793.25,50 L803.25,50 L793.25,40 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="77" x="453.25" y="57.0669">Conditions</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="453.25" y="72.1997">state=Suspend or state=Created</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301" x="453.25" y="87.3325">state=Processing &amp;&amp; task-id="CurrentTaskId"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335" x="453.25" y="102.4653">state=Delayed &amp;&amp; postponed-to &lt;= "CurrentTime"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="457.25" y="117.5981"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="157" x="453.25" y="132.731">Set ExecutionContext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="453.25" y="147.8638">state=Processing</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="453.25" y="162.9966">task-id="CurrentTaskId"</text><rect fill="#FEFECE" filter="url(#f2l792frt5f7i)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="176" x="251.25" y="88.5469"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="156" x="261.25" y="109.6855">Try to "capture" payment</text><polygon fill="#FEFECE" filter="url(#f2l792frt5f7i)" points="310.75,191.0625,367.75,191.0625,379.75,203.0625,367.75,215.0625,310.75,215.0625,298.75,203.0625,310.75,191.0625" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="57" x="310.75" y="206.8706">Is success</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="26" x="272.75" y="200.4683">True</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="29" x="379.75" y="200.4683">False</text><rect fill="#FEFECE" filter="url(#f2l792frt5f7i)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="248" x="71.5" y="225.0625"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="228" x="81.5" y="246.2012">Processing the payment by the agent</text><line style="stroke:#A80036;stroke-width:1.5;" x1="38.5" x2="287.5" y1="300.4302" y2="300.4302"/><rect fill="#FEFECE" filter="url(#f2l792frt5f7i)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="55" x="11" y="354.9146"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="35" x="21" y="376.0532">Finish</text><rect fill="#FEFECE" filter="url(#f2l792frt5f7i)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="73" x="94" y="354.9146"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="53" x="104" y="376.0532">Suspend</text><rect fill="#FEFECE" filter="url(#f2l792frt5f7i)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="68" x="253.5" y="320.4302"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="48" x="263.5" y="341.5688">Delayed</text><rect fill="#FEFECE" filter="url(#f2l792frt5f7i)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="185" x="195" y="389.3989"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="165" x="205" y="410.5376">Schedule a new processing</text><line style="stroke:#A80036;stroke-width:1.5;" x1="38.5" x2="287.5" y1="443.3677" y2="443.3677"/><rect fill="#FEFECE" filter="url(#f2l792frt5f7i)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="95" x="148" y="463.3677"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="75" x="158" y="484.5063">Ack the task</text><rect fill="#FEFECE" filter="url(#f2l792frt5f7i)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="95" x="435.5" y="225.0625"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="75" x="445.5" y="246.2012">Ack the task</text><polygon fill="#FEFECE" filter="url(#f2l792frt5f7i)" points="339.25,503.3364,351.25,515.3364,339.25,527.3364,327.25,515.3364,339.25,503.3364" style="stroke:#A80036;stroke-width:1.5;"/><ellipse cx="339.25" cy="558.3364" fill="#FFFFFF" filter="url(#f2l792frt5f7i)" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="339.25" cy="558.3364" fill="#000000" rx="6" ry="6" style="stroke:#7F7F7F;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="339.25" x2="339.25" y1="30" y2="88.5469"/><polygon fill="#A80036" points="335.25,78.5469,339.25,88.5469,343.25,78.5469,339.25,82.5469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="287.5" x2="287.5" y1="354.3989" y2="389.3989"/><polygon fill="#A80036" points="283.5,379.3989,287.5,389.3989,291.5,379.3989,287.5,383.3989" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="38.5" x2="38.5" y1="301.9302" y2="354.9146"/><polygon fill="#A80036" points="34.5,344.9146,38.5,354.9146,42.5,344.9146,38.5,348.9146" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="130.5" x2="130.5" y1="301.9302" y2="354.9146"/><polygon fill="#A80036" points="126.5,344.9146,130.5,354.9146,134.5,344.9146,130.5,348.9146" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="287.5" x2="287.5" y1="301.9302" y2="320.4302"/><polygon fill="#A80036" points="283.5,310.4302,287.5,320.4302,291.5,310.4302,287.5,314.4302" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="38.5" x2="38.5" y1="388.8833" y2="443.3677"/><polygon fill="#A80036" points="34.5,433.3677,38.5,443.3677,42.5,433.3677,38.5,437.3677" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="130.5" x2="130.5" y1="388.8833" y2="443.3677"/><polygon fill="#A80036" points="126.5,433.3677,130.5,443.3677,134.5,433.3677,130.5,437.3677" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="287.5" x2="287.5" y1="423.3677" y2="443.3677"/><polygon fill="#A80036" points="283.5,433.3677,287.5,443.3677,291.5,433.3677,287.5,437.3677" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="195.5" x2="195.5" y1="259.0313" y2="300.4302"/><polygon fill="#A80036" points="191.5,290.4302,195.5,300.4302,199.5,290.4302,195.5,294.4302" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="216" x="199.5" y="280.3359">Switch the context by ExecutionResult</text><line style="stroke:#A80036;stroke-width:1.5;" x1="195.5" x2="195.5" y1="444.8677" y2="463.3677"/><polygon fill="#A80036" points="191.5,453.3677,195.5,463.3677,199.5,453.3677,195.5,457.3677" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="298.75" x2="195.5" y1="203.0625" y2="203.0625"/><line style="stroke:#A80036;stroke-width:1.5;" x1="195.5" x2="195.5" y1="203.0625" y2="225.0625"/><polygon fill="#A80036" points="191.5,215.0625,195.5,225.0625,199.5,215.0625,195.5,219.0625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="379.75" x2="483" y1="203.0625" y2="203.0625"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483" x2="483" y1="203.0625" y2="225.0625"/><polygon fill="#A80036" points="479,215.0625,483,225.0625,487,215.0625,483,219.0625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="195.5" x2="195.5" y1="497.3364" y2="515.3364"/><line style="stroke:#A80036;stroke-width:1.5;" x1="195.5" x2="327.25" y1="515.3364" y2="515.3364"/><polygon fill="#A80036" points="317.25,511.3364,327.25,515.3364,317.25,519.3364,321.25,515.3364" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483" x2="483" y1="259.0313" y2="515.3364"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483" x2="351.25" y1="515.3364" y2="515.3364"/><polygon fill="#A80036" points="361.25,511.3364,351.25,515.3364,361.25,519.3364,357.25,515.3364" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="339.25" x2="339.25" y1="122.5156" y2="191.0625"/><polygon fill="#A80036" points="335.25,181.0625,339.25,191.0625,343.25,181.0625,339.25,185.0625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="339.25" x2="339.25" y1="527.3364" y2="547.3364"/><polygon fill="#A80036" points="335.25,537.3364,339.25,547.3364,343.25,537.3364,339.25,541.3364" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[7c125c8249edea19a3e16efb2c2ab1c8]
@startuml

start

:Try to "capture" payment;
note right
<b>Conditions</b>
state=Suspend or state=Created
state=Processing && task-id="CurrentTaskId"
state=Delayed && postponed-to <= "CurrentTime"

<b>Set ExecutionContext</b>
state=Processing
task-id="CurrentTaskId"
end note

if (Is success) then
-> True;
:Processing the payment by the agent;
-> Switch the context by ExecutionResult;
split
   :Finish;
split again
   :Suspend;
split again
   :Delayed;
   :Schedule a new processing;
end split

:Ack the task;
else
-> False;
:Ack the task;
endif

stop

@enduml

PlantUML version 1.2021.01(Tue Feb 02 14:55:08 NOVT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>